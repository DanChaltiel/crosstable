# crosstable

Crosstable is a package centered on a single function, `crosstable`,
which easily computes descriptive statistics on datasets. It can use the
`tidyverse` syntax and is interfaced with the package `officer` to
create automatized reports.

## Installation

``` r
# Install last version available on CRAN
install.packages("crosstable")

# Install development version on Github
remotes::install_github("DanChaltiel/crosstable@v0.8.2.9006")
```

Note that, for reproducibility purpose, an even better solution would be
to use [`renv`](https://rstudio.github.io/renv/articles/renv.html).

## Overview

Here are 2 examples to try and show you the main features of
`crosstable`. See the [documentation
website](https://danchaltiel.github.io/crosstable/) for more.

#### Example \#1

> Dear crosstable, using the `mtcars2` dataset, please describe columns
> `disp` and `vs` depending on the levels of column `am`, with totals in
> both rows and columns, and with proportions formatted with group size,
> percent on row and percent on column, with no decimals.

``` r
library(crosstable)
ct1 = crosstable(mtcars2, c(disp, vs), by=am, total="both", 
                 percent_pattern="{n} ({p_row}/{p_col})", percent_digits=0) %>%
  as_flextable()
ct1
```

![crosstable1](reference/figures/ct1_mod.png)

With only a few arguments, we did select which column to describe
(`c(disp, vs)`), define a grouping variable (`by=am`), set the
percentage calculation in row/column (`percent_pattern=`), and ask for
totals (`total=`).

Since `mtcars2` is a dataset with labels, they are displayed instead of
the variable name (see
[here](https://danchaltiel.github.io/crosstable/articles/crosstable.html#dataset-modified-mtcars)
for how to add some).

As
[`crosstable()`](https://danchaltiel.github.io/crosstable/reference/crosstable.md)
is returning a `data.frame`, we use
[`as_flextable()`](https://danchaltiel.github.io/crosstable/reference/as_flextable.md)
to output a beautiful HTML table. This one can even be exported to MS
Word with a few more lines of code (see
[here](https://danchaltiel.github.io/crosstable/articles/crosstable-report.html)
to learn how).

#### Example \#2

Here is a more advanced example.

> Dear crosstable, using the `mtcars2` dataset again, please describe
> all columns whose name starts with “cy” and those whose name ends with
> “at”, depending on the levels of both columns `am` and `vs`, without
> considering labels, applying
> [`mean()`](https://rdrr.io/r/base/mean.html) and
> [`quantile()`](https://rdrr.io/r/stats/quantile.html) as summary
> function, with `probs` 25% and 75% defined for this latter function,
> and with 3 decimals for numeric variables:

``` r
ct2 = crosstable(mtcars2, c(starts_with("cy"), ends_with("at")), by=c(am, vs), 
                 label=FALSE, num_digits=3, funs=c(mean, quantile), 
                 funs_arg=list(probs=c(.25,.75))) %>% 
  as_flextable(compact=TRUE, header_show_n=1:2)
ct2
```

![crosstable2](reference/figures/ct2_mod.png)

Here, the variables were selected using `tidyselect` helpers and the
summary functions `mean` and `quantile` were specified, along with
argument `probs` for the latter. Using `label=FALSE` allowed to see
which variables were selected but it is best to keep the labels in the
final table.

In
[`as_flextable()`](https://danchaltiel.github.io/crosstable/reference/as_flextable.md),
the `compact=TRUE` option yields a longer output, which may be more
suited in some contexts (for instance for publication), and
`header_show_n=1:2` adds the group sizes for both rows of the header.

## Documentation

You can find the whole documentation on the [dedicated
website](https://danchaltiel.github.io/crosstable/):

- [`vignette("crosstable")`](https://danchaltiel.github.io/crosstable/articles/crosstable.md)
  for a first step-by-step guide on how to use `crosstable`
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable.html))
- [`vignette("crosstable-report")`](https://danchaltiel.github.io/crosstable/articles/crosstable-report.md)
  for more on creating MS Word reports using either
  [officer](https://ardata-fr.github.io/officeverse/) or `Rmarkdown`
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable-report.html))
- `vignette("pertent_pattern")` for more on how to use `percent_pattern`
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable-selection.html))
- [`vignette("crosstable-selection")`](https://danchaltiel.github.io/crosstable/articles/crosstable-selection.md)
  for more on variable selection
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable-selection.html)),
  although you should better read
  <https://tidyselect.r-lib.org/articles/syntax.html>.

There are lots of other features you can learn about there, for instance
(non-exhaustive list):

- description of correlation, dates, and survival data
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable.html#miscellaneous-1))
- variable selection with functions, e.g. `is.numeric`
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable-selection.html#select-with-predicate-functions))
- formula interface, allowing to describe more mutated columns,
  e.g. `sqrt(mpg)` or `Surv(time, event)`
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable-selection.html#select-with-a-formula))
- automatic computation of statistical tests
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable.html#tests))
  and of effect sizes
  ([link](https://danchaltiel.github.io/crosstable/articles/crosstable.html#effects))
- global options to avoid repeating arguments
  ([link](https://danchaltiel.github.io/crosstable/reference/crosstable_options.html))

## Getting help and giving feedback

If you have a question about how to use `crosstable`, please ask on
[StackOverflow](https://stackoverflow.com/) with the tag `crosstable`.
You can `@DanChaltiel` in a comment if you are struggling to get
answers. Don’t forget to add a minimal **repr**oducible **ex**ample to
your question, ideally using the [reprex](https://reprex.tidyverse.org/)
package.

If you miss any feature that you think would belong in `crosstable`,
please fill a [Feature
Request](https://github.com/DanChaltiel/crosstable/issues/new/choose)
issue.

If you encounter an unexpected error while using `crosstable`, please
fill a [Bug
Report](https://github.com/DanChaltiel/crosstable/issues/new/choose)
issue. In case of any installation problem, try the solutions proposed
in [this
article](https://danchaltiel.github.io/crosstable/articles/crosstable-install.html)
first.

## Acknowledgement

In its earliest development phase, `crosstable` was based on the awesome
package [`biostat2`](https://github.com/eusebe/biostat2) written by
David Hajage. Thanks David!

# Package index

## Main function

- [`crosstable()`](https://danchaltiel.github.io/crosstable/reference/crosstable.md)
  : Easily describe datasets

- [`crosstable_options()`](https://danchaltiel.github.io/crosstable/reference/crosstable_options.md)
  :

  Options for the package `crosstable`

- [`crosstable_peek_options()`](https://danchaltiel.github.io/crosstable/reference/crosstable_peek_options.md)
  :

  See which `crosstable` option is currently set.

- [`crosstable_reset_options()`](https://danchaltiel.github.io/crosstable/reference/crosstable_reset_options.md)
  :

  Reset all `crosstable` options.

## Datasets

Standard datasets, modified to have labels, characters, and factors

- [`iris2`](https://danchaltiel.github.io/crosstable/reference/iris2.md)
  :

  Modified `iris` dataset

- [`mtcars2`](https://danchaltiel.github.io/crosstable/reference/mtcars2.md)
  :

  Modified `mtcars` dataset

## Labelling

Handle label attributes (compatible with Hmisc, expss, haven…)

- [`import_labels()`](https://danchaltiel.github.io/crosstable/reference/import_labels.md)
  [`save_labels()`](https://danchaltiel.github.io/crosstable/reference/import_labels.md)
  : Import labels
- [`set_label()`](https://danchaltiel.github.io/crosstable/reference/set_label.md)
  [`copy_label_from()`](https://danchaltiel.github.io/crosstable/reference/set_label.md)
  : Set the "label" attribute of an object
- [`get_label()`](https://danchaltiel.github.io/crosstable/reference/get_label.md)
  : Get label if wanted and available, or default (name) otherwise
- [`remove_labels()`](https://danchaltiel.github.io/crosstable/reference/remove_labels.md)
  : Remove all label attributes.
- [`apply_labels()`](https://danchaltiel.github.io/crosstable/reference/apply_labels.md)
  : Batch set variable labels
- [`rename_with_labels()`](https://danchaltiel.github.io/crosstable/reference/rename_with_labels.md)
  : Rename every column of a dataframe with its label
- [`clean_names_with_labels()`](https://danchaltiel.github.io/crosstable/reference/clean_names_with_labels.md)
  : Cleans names of a dataframe while retaining old names as labels

## Post-processing

Modify an already built crosstable

- [`transpose_crosstable()`](https://danchaltiel.github.io/crosstable/reference/transpose_crosstable.md)
  [`t(`*`<crosstable>`*`)`](https://danchaltiel.github.io/crosstable/reference/transpose_crosstable.md)
  : Transpose a crosstable
- [`pivot_crosstable()`](https://danchaltiel.github.io/crosstable/reference/pivot_crosstable.md)
  : Pivot a crosstable

## Summary functions

Summarise numeric variables

- [`meansd()`](https://danchaltiel.github.io/crosstable/reference/summaryFunctions.md)
  [`meanCI()`](https://danchaltiel.github.io/crosstable/reference/summaryFunctions.md)
  [`mediqr()`](https://danchaltiel.github.io/crosstable/reference/summaryFunctions.md)
  [`minmax()`](https://danchaltiel.github.io/crosstable/reference/summaryFunctions.md)
  [`nna()`](https://danchaltiel.github.io/crosstable/reference/summaryFunctions.md)
  : Summary functions
- [`cross_summary()`](https://danchaltiel.github.io/crosstable/reference/cross_summary.md)
  : Summarize a numeric vector
- [`na()`](https://danchaltiel.github.io/crosstable/reference/na.md) :
  Return the number of NA observations
- [`N()`](https://danchaltiel.github.io/crosstable/reference/n.md) :
  Return the number of non NA observations

## Visualization

Visualize a crosstable in various formats

- [`as_gt()`](https://danchaltiel.github.io/crosstable/reference/as_gt.md)
  :

  Converts a `crosstable` object into a formatted `gt` table.

- [`as_workbook()`](https://danchaltiel.github.io/crosstable/reference/as_workbook.md)
  :

  Converts a `crosstable` object into a formatted, savable `openxlsx`
  workbook.

- [`as_flextable()`](https://danchaltiel.github.io/crosstable/reference/as_flextable.md)
  :

  Turns a `crosstable` object into a formatted `flextable`

## Officer helpers

Used in cooperation with the `officer` package

- [`body_add_crosstable()`](https://danchaltiel.github.io/crosstable/reference/body_add_crosstable.md)
  :

  Add a crosstable to an `officer` document

- [`body_add_crosstable_footnote()`](https://danchaltiel.github.io/crosstable/reference/body_add_crosstable_footnote.md)
  : Adds a standard footnote explaining the abbreviations used in a
  crosstable

- [`body_add_flextable2()`](https://danchaltiel.github.io/crosstable/reference/body_add_flextable2.md)
  :

  Alternative to
  [`flextable::body_add_flextable()`](https://davidgohel.github.io/flextable/reference/body_add_flextable.html)

- [`body_add_gg2()`](https://danchaltiel.github.io/crosstable/reference/body_add_gg2.md)
  :

  Alternative to
  [`officer::body_add_gg()`](https://davidgohel.github.io/officer/reference/body_add_gg.html)
  which uses `ggplot` syntax

- [`body_add_img2()`](https://danchaltiel.github.io/crosstable/reference/body_add_img2.md)
  :

  Alternative to
  [`officer::body_add_img()`](https://davidgohel.github.io/officer/reference/body_add_img.html)
  which adds a `units` choice

- [`body_add_table_legend()`](https://danchaltiel.github.io/crosstable/reference/body_add_legend.md)
  [`body_add_figure_legend()`](https://danchaltiel.github.io/crosstable/reference/body_add_legend.md)
  : Add a legend to a table or a figure

- [`body_add_list()`](https://danchaltiel.github.io/crosstable/reference/body_add_list.md)
  [`body_add_list_item()`](https://danchaltiel.github.io/crosstable/reference/body_add_list.md)
  :

  Add a list to an `officer` document

- [`body_add_normal()`](https://danchaltiel.github.io/crosstable/reference/body_add_normal.md)
  : Add a new paragraph with default style

- [`body_add_table_list()`](https://danchaltiel.github.io/crosstable/reference/body_add_table_list.md)
  [`body_add_flextable_list()`](https://danchaltiel.github.io/crosstable/reference/body_add_table_list.md)
  [`body_add_crosstable_list()`](https://danchaltiel.github.io/crosstable/reference/body_add_table_list.md)
  : Add a list of tables

- [`body_add_table_section()`](https://danchaltiel.github.io/crosstable/reference/body_add_table_section.md)
  : Add a section with a table and its legend

- [`body_add_title()`](https://danchaltiel.github.io/crosstable/reference/body_add_title.md)
  :

  Add a title to an `officer` document

- [`body_replace_text_at_bkms()`](https://danchaltiel.github.io/crosstable/reference/body_replace_text_at_bkms.md)
  : Replace text on several bookmarks at once

- [`docx_bookmarks2()`](https://danchaltiel.github.io/crosstable/reference/docx_bookmarks2.md)
  : List Word bookmarks, including the ones in header and footer

- [`write_and_open()`](https://danchaltiel.github.io/crosstable/reference/write_and_open.md)
  :

  Alternative to default `officer` print() function. Write the file and
  try to open it right away.

- [`generate_autofit_macro()`](https://danchaltiel.github.io/crosstable/reference/generate_autofit_macro.md)
  : Generate a macro file for autofitting

## Utils

Practical functions for various purposes

- [`get_percent_pattern()`](https://danchaltiel.github.io/crosstable/reference/get_percent_pattern.md)
  : Percent pattern helper

- [`format_fixed()`](https://danchaltiel.github.io/crosstable/reference/format_fixed.md)
  : Format numbers with the exact same number of decimals, including
  trailing zeros

- [`ct_compact(`*`<data.frame>`*`)`](https://danchaltiel.github.io/crosstable/reference/ct_compact.md)
  [`ct_compact(`*`<crosstable>`*`)`](https://danchaltiel.github.io/crosstable/reference/ct_compact.md)
  : Generic function to compact a table (publication formatting)

- [`ct_bind_cols()`](https://danchaltiel.github.io/crosstable/reference/ct_bind_cols.md)
  **\[experimental\]** : Combine crosstables

- [`plim()`](https://danchaltiel.github.io/crosstable/reference/plim.md)
  :

  Format p values (alternative to
  [`format.pval()`](https://rdrr.io/r/base/format.pval.html))

- [`confint_numeric()`](https://danchaltiel.github.io/crosstable/reference/confint_numeric.md)
  : Confidence interval of a numeric vector

- [`narm()`](https://danchaltiel.github.io/crosstable/reference/narm.md)
  : Remove missing values

- [`is.crosstable()`](https://danchaltiel.github.io/crosstable/reference/is.crosstable.md)
  [`is.transposed_crosstable()`](https://danchaltiel.github.io/crosstable/reference/is.crosstable.md)
  [`is.compacted_crosstable()`](https://danchaltiel.github.io/crosstable/reference/is.crosstable.md)
  [`is.multiby_crosstable()`](https://danchaltiel.github.io/crosstable/reference/is.crosstable.md)
  : Test if an object is a crosstable

- [`peek()`](https://danchaltiel.github.io/crosstable/reference/peek.md)
  :

  Open a `crosstable` in a temporary document

## Effects and tests

### Default parameters

- [`crosstable_effect_args()`](https://danchaltiel.github.io/crosstable/reference/crosstable_effect_args.md)
  :

  Default arguments for calculating and displaying effects in
  [`crosstable()`](https://danchaltiel.github.io/crosstable/reference/crosstable.md)

- [`crosstable_test_args()`](https://danchaltiel.github.io/crosstable/reference/crosstable_test_args.md)
  :

  Default arguments for calculating and displaying tests in
  [`crosstable()`](https://danchaltiel.github.io/crosstable/reference/crosstable.md)

### Effects

- [`display_effect()`](https://danchaltiel.github.io/crosstable/reference/display_effect.md)
  : Default function to display the effect
- [`diff_mean_auto()`](https://danchaltiel.github.io/crosstable/reference/effect_summary.md)
  [`diff_mean_boot()`](https://danchaltiel.github.io/crosstable/reference/effect_summary.md)
  [`diff_median_boot()`](https://danchaltiel.github.io/crosstable/reference/effect_summary.md)
  [`diff_mean_student()`](https://danchaltiel.github.io/crosstable/reference/effect_summary.md)
  : Effect measure for association between one continuous and one
  categorical variable
- [`effect_survival_coxph()`](https://danchaltiel.github.io/crosstable/reference/effect_survival.md)
  : Effect measure for association between one censored variable and one
  categorical variable
- [`effect_odds_ratio()`](https://danchaltiel.github.io/crosstable/reference/effect_tabular.md)
  [`effect_relative_risk()`](https://danchaltiel.github.io/crosstable/reference/effect_tabular.md)
  [`effect_risk_difference()`](https://danchaltiel.github.io/crosstable/reference/effect_tabular.md)
  : Effect measure for association between two categorical variables

### Tests

- [`display_test()`](https://danchaltiel.github.io/crosstable/reference/display_test.md)
  : Default function to display a test result

- [`crosstable_test_args()`](https://danchaltiel.github.io/crosstable/reference/crosstable_test_args.md)
  :

  Default arguments for calculating and displaying tests in
  [`crosstable()`](https://danchaltiel.github.io/crosstable/reference/crosstable.md)

- [`test_correlation_auto()`](https://danchaltiel.github.io/crosstable/reference/test_correlation_auto.md)
  : test for correlation coefficients

- [`test_summarize_auto()`](https://danchaltiel.github.io/crosstable/reference/test_summarize_auto.md)
  : test for mean comparison

- [`test_summarize_linear_contrasts()`](https://danchaltiel.github.io/crosstable/reference/test_summarize_linear_contrasts.md)
  : Test for linear trend across ordered factor with contrasts

- [`test_survival_logrank()`](https://danchaltiel.github.io/crosstable/reference/test_survival_logrank.md)
  : test for survival comparison

- [`test_tabular_auto()`](https://danchaltiel.github.io/crosstable/reference/test_tabular_auto.md)
  : test for contingency table

# Articles

### Articles

- [Introduction to
  Crosstable](https://danchaltiel.github.io/crosstable/articles/crosstable.md):
- [Select
  variables](https://danchaltiel.github.io/crosstable/articles/crosstable-selection.md):
- [Make automatic
  reports](https://danchaltiel.github.io/crosstable/articles/crosstable-report.md):
- [Using
  \`percent_pattern\`](https://danchaltiel.github.io/crosstable/articles/percent_pattern.md):
